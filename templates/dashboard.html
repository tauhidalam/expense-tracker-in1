{% extends "base.html" %}

{% block content %}
    <h2>Dashboard</h2>

    <!-- Display Total Available Amount with conditional background color -->
    <div class="alert mt-4" 
         style="background-color: {{ balance_color }}; color: white;">
        <strong>Total Available Amount: ₹{{ total_available }}</strong>
    </div>

    <!-- Display Total Outstanding Amount with conditional background color -->
    <div class="alert mt-4" 
         style="background-color: {{ outstanding_color }}; color: white;">
        <strong>Total Credit Card Outstanding: ₹{{ total_outstanding }}</strong>
    </div>

    <!-- Display recent expenses -->
    <h3 class="mt-4">Recent Expenses</h3>
    <table class="table table-bordered mt-3">
        <thead>
            <tr>
                <th>Date</th>
                <th>Description</th>
                <th>Amount</th>
                <th>Spend Source</th>
            </tr>
        </thead>
        <tbody>
            {% for expense in expenses %}
            <tr>
                <td>{{ expense.date.strftime('%Y-%m-%d') }}</td>
                <td>{{ expense.description }}</td>
                <td>₹{{ expense.amount }}</td>
                <td>{{ expense.spend_source }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="4" class="text-center">No expenses available</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Display credit cards with outstanding balances -->
    <h3 class="mt-4">Credit Cards</h3>
    <table class="table table-bordered mt-3">
        <thead>
            <tr>
                <th>Name</th>
                <th>Credit Limit</th>
                <th>Available Limit</th>
                <th>Outstanding</th>
            </tr>
        </thead>
        <tbody>
            {% for card in credit_cards %}
            <tr>
                <td>{{ card.name }}</td>
                <td>₹{{ card.credit_limit }}</td>
                <td>₹{{ card.available_limit }}</td>
                <td>₹{{ card.outstanding }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="4" class="text-center">No credit cards available</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Display existing funds -->
    <h3 class="mt-4">Funds</h3>
    <table class="table table-bordered mt-3">
        <thead>
            <tr>
                <th>Fund Type</th>
                <th>Amount</th>
                <th>Allocation Date</th>
            </tr>
        </thead>
        <tbody>
            {% for fund in funds %}
            <tr>
                <td>{{ fund.fund_type }}</td>
                <td>₹{{ fund.amount }}</td>
                <td>{{ fund.allocation_date.strftime('%Y-%m-%d') }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="3" class="text-center">No funds available</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Button to generate plots -->
    <div class="mt-4">
        <form action="{{ url_for('generate_plots') }}" method="post">
            <button type="submit" class="btn btn-primary">Generate Plots</button>
        </form>
    </div>
{% endblock %}
